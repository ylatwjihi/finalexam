<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام الاختبارات الإلكتروني - اللغة العربية</title>
    <style>
        :root {
            --primary-color: #3d6e6a; /* أخضر غامق بارد */
            --secondary-color: #455A64; /* رمادي مزرق */
            --light-color: #CFD8DC; /* رمادي فاتح */
            --dark-color: #263238; /* أسود رمادي */
            --correct-color: #4CAF50; /* أخضر للإجابات الصحيحة */
            --wrong-color: #F44336; /* أحمر للإجابات الخاطئة */
        }
            
        * {
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            margin: 0;
            padding: 20px;
            color: var(--dark-color);
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
            position: relative;
        }
        
        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 30px;
            font-size: 28px;
        }
        
        .timer {
            background-color: var(--primary-color);
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            display: inline-block;
            position: absolute;
            left: 30px;
            top: 30px;
        }
        
        .units-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        .unit-btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .unit-btn:hover {
            background-color: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .quiz-section {
            display: none;
        }
        
        .quiz-section.active {
            display: block;
        }
        
        .question-part {
            display: none;
            margin-bottom: 30px;
        }
        
        .question-part.active {
            display: block;
        }
        
        .question {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-right: 4px solid var(--primary-color);
        }
        
        .question h3 {
            margin-top: 0;
            color: var(--secondary-color);
        }
        
        .options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        @media (max-width: 600px) {
            .options {
                grid-template-columns: 1fr;
            }
        }
        
        .option {
            background-color: white;
            border: 1px solid var(--light-color);
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        
        .option:hover {
            border-color: var(--secondary-color);
        }
        
        .option.selected {
            border-color: var(--primary-color);
            background-color: rgba(46, 125, 50, 0.1);
        }
        
        .navigation-btns {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .nav-btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .nav-btn:hover {
            background-color: var(--primary-color);
        }
        
        .nav-btn:disabled {
            background-color: var(--light-color);
            cursor: not-allowed;
        }
        
        .submit-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            display: block;
            margin: 30px auto 0;
        }
        
        .submit-btn:hover {
            background-color: #1B5E20;
        }
        
        .results {
            display: none;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 8px;
            margin-top: 30px;
        }
        
        .results h2 {
            color: var(--primary-color);
            text-align: center;
        }
        
        .result-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--light-color);
        }
        
        .result-item:last-child {
            border-bottom: none;
        }
        
        .result-question {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .user-answer.correct {
            color: var(--correct-color);
        }
        
        .user-answer.wrong {
            color: var(--wrong-color);
        }
        
        .correct-answer {
            color: var(--correct-color);
            font-weight: bold;
        }
        
        .score-display {
            text-align: center;
            font-size: 24px;
            margin: 20px 0;
            color: var(--primary-color);
        }
        
        .time-taken {
            text-align: center;
            font-size: 18px;
            color: var(--secondary-color);
            margin-bottom: 20px;
        }
        
        .print-btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            display: block;
            margin: 20px auto;
        }
        
        .print-btn:hover {
            background-color: #37474F;
        }
        
        @media print {
            body * {
                visibility: hidden;
            }
            .container, .container * {
                visibility: visible;
            }
            .container {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
            }
            .unit-btn, .timer, .nav-btn, .submit-btn, .print-btn {
                display: none !important;
            }
        }
    </style>
</head>
<body>


    <div class="container">
        <h1 style="margin-top: 50px;" id="subject-name">نظام الاختبارات الإلكتروني | التربية الإسلامية</h1>
        
    <!-- 🔷 إحصائيات اللغة العربية -->
<div class="overall-results" id="overall-results-arabic">
    <h3>📊 معدل مادة التربية الإسلامية</h3>
    <canvas id="overallResultsChartArabic"></canvas>
    <div id="overallResultsDetailsArabic" class="overall-stats"></div>
</div>

<!-- مكتبة الرسم البياني -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- تنسيقات -->
<style>
.overall-results {
    padding: 15px;
    margin: 20px 0;
    background-color: #f9f9f9;
    border-radius: 10px;
    text-align: center;
    box-shadow: 0 0 10px rgba(0,0,0,0.05);
}
#overallResultsChartArabic {
    max-width: 400px;
    margin: 0 auto 20px;
}
.overall-stats {
    font-weight: bold;
    color: #3d6e6a;
}
</style>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const subjectKey = 'arabic';

    const ctx = document.getElementById('overallResultsChartArabic').getContext('2d');
    const chart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['إجابات صحيحة', 'إجابات خاطئة'],
            datasets: [{
                data: [0, 0],
                backgroundColor: ['#4CAF50', '#F44336']
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { position: 'bottom' }
            }
        }
    });

    function updateOverallResults() {
        const allResults = JSON.parse(localStorage.getItem('quiz_results_' + subjectKey)) || [];
        let totalCorrect = 0;
        let totalQuestions = 0;

        allResults.forEach(r => {
            totalCorrect += r.score;
            totalQuestions += r.total;
        });

        const percent = totalQuestions ? Math.round((totalCorrect / totalQuestions) * 100) : 0;

        document.getElementById('overallResultsDetailsArabic').textContent =
            `عدد المحاولات: ${allResults.length} | المعدل العام: ${percent}%`;

        chart.data.datasets[0].data = [totalCorrect, totalQuestions - totalCorrect];
        chart.update();
    }

    // نداء مباشر لتحديث الرسم
    updateOverallResults();

    // 🟢 نداء هذه الدالة في نهاية الاختبار لحفظ النتيجة
    window.saveQuizResult = function(score, total, timeSpentText = '') {
        let allResults = JSON.parse(localStorage.getItem('quiz_results_' + subjectKey)) || [];
        allResults.push({
            score: score,
            total: total,
            percentage: Math.round((score / total) * 100),
            timeSpent: timeSpentText
        });
        localStorage.setItem('quiz_results_' + subjectKey, JSON.stringify(allResults));
        updateOverallResults();
    };
});
</script>
        <div class="timer" id="timer">00:00</div>
        
        <div class="units-list" id="units-list">
            <!-- سيتم ملء هذا القسم بالوحدات عبر JavaScript -->
        </div>
        
        <div class="quiz-section" id="quiz-section">
            <div class="question-part active" data-part="1">
                <!-- سيتم ملء الأسئلة عبر JavaScript -->
            </div>
            
            <div class="navigation-btns">
                <button class="nav-btn" id="prev-btn" disabled>السابق</button>
                <button class="nav-btn" id="next-btn">التالي</button>
            </div>
            
            <button class="submit-btn" id="submit-btn">تسليم الإجابات</button>
        </div>
        
        <div class="results" id="results">
            <h2>نتيجة الاختبار</h2>
            <div class="score-display" id="score-display"></div>
            <div class="time-taken" id="time-taken"></div>
            <div id="results-content">
                <!-- سيتم ملء النتائج هنا -->
            </div>
            <button class="print-btn" id="print-btn">تصدير النتيجة كملف PDF</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // بيانات الاختبار
            const subjectName = "تربية إسلامية - جميع الفروع";
            const units = [
                { id: 1, name: "اختبار شامل - النموذج الأول" },
                { id: 2, name: "اختبار شامل - النموذج الثاني" },
            ];
            
            const quizzes = {
    1:[
    
    {
      "id": 1,
      "question": "ما المقصود بـ (توكيد الشيء بذكر اسم الله تعالى أو صفة من صفاته)؟",
      "options": ["الشرط", "النذر", "الكفارة", "اليمين"],
      "answer": "اليمين"
    },
    {
      "id": 2,
      "question": "ما حكم اليمين في الشهادة أمام القاضي لإثبات حق لمستحقه؟",
      "options": ["مكروهة", "واجبة", "مندوبة", "مباحة"],
      "answer": "واجبة"
    },
    {
      "id": 3,
      "question": "أي من الآتي لا يعتبر من كفارة اليمين على التخيير؟",
      "options": ["الصوم", "كسوة عشرة مساكين", "تحرير رقبة مؤمنة", "إطعام عشرة مساكين"],
      "answer": "كسوة عشرة مساكين"
    },
    {
      "id": 4,
      "question": "ما حكم النذر في الأصل؟",
      "options": ["واجب", "مكروه", "مباح", "حرام"],
      "answer": "مكروه"
    },
    {
      "id": 5,
      "question": "ما المقصود بـ (اليمين المنعقدة)؟",
      "options": [
        "اليمين التي تغمس صاحبها في النار",
        "الحلف مع تعمد الكذب",
        "الحلف دون قصد اليمين",
        "الحلف مع قصد اليمين"
      ],
      "answer": "الحلف مع قصد اليمين"
    },
    {
      "id": 6,
      "question": "علام يدل قوله تعالى: \"لا يؤاخذكم الله باللغو في أيمانكم\"؟",
      "options": [
        "وجوب الكفارة في اليمين المنعقدة",
        "وجوب الكفارة في يمين اللغو",
        "وجوب الوفاء باليمين",
        "لا كفارة في يمين اللغو"
      ],
      "answer": "لا كفارة في يمين اللغو"
    },
    {
      "id": 7,
      "question": "علام اعتمدت الدعوة في العهد المكي؟",
      "options": [
        "مقاومة الحجة بالحجة",
        "حد السيف",
        "الإنذار قبل القتال",
        "المواجهة العسكرية"
      ],
      "answer": "مقاومة الحجة بالحجة"
    },
    {
      "id": 8,
      "question": "ما المعنى المستفاد من قول النبي -صلى الله عليه وسلم-: \"ما ترك قوم الجهاد إلا عمهم الله بالعذاب\"؟",
      "options": [
        "الجهاد عز وتمكين في الأرض",
        "الجهاد تجارة رابحة مع الله تعالى",
        "الجهاد ذروة سنام الإسلام",
        "الجهاد أفضل الأعمال إلى الله"
      ],
      "answer": "الجهاد عز وتمكين في الأرض"
    },
    {
      "id": 9,
      "question": "ما الذي يُستثنى من جهاد فرض العين مما يأتي؟",
      "options": [
        "إذا كان بين المسلمين وبين البلاد الأخرى عهد",
        "إذا احتل العدو بلداً من بلاد المسلمين",
        "إذا حضر المقاتل ساحة القتال",
        "إذا استنفر الإمام فئة من الناس للقتال"
      ],
      "answer": "إذا كان بين المسلمين وبين البلاد الأخرى عهد"
    },
    {
      "id": 10,
      "question": "ما الحِكم من عدم مشروعية القتال في العهد المكي؟",
      "options": [
        "أولوية ترسيخ العقيدة",
        "سد الذرائع",
        "حماية المسلمين",
        "ترسيخ العقيدة وحماية المسلمين وسد الذرائع"
      ],
      "answer": "ترسيخ العقيدة وحماية المسلمين وسد الذرائع"
    },
    {
      "id": 11,
      "question": "ما العام الذي ولد فيه العز بن عبد السلام بدمشق؟",
      "options": ["576 هـ", "578 هـ", "577 هـ", "579 هـ"],
      "answer": "577 هـ"
    },
    {
      "id": 12,
      "question": "ما المعركة التي اشترك العز بن عبد السلام بقتال التتار فيها؟",
      "options": ["حطين", "عين جالوت", "شقحب", "دمياط"],
      "answer": "عين جالوت"
    },
    {
      "id": 13,
      "question": "من هو الذي لُقب بسلطان العلماء وبائع الأمراء؟",
      "options": [
        "ابن قيم الجوزية",
        "تقي الدين السبكي",
        "ابن تيمية",
        "العز بن عبد السلام"
      ],
      "answer": "العز بن عبد السلام"
    },
    {
      "id": 14,
      "question": "ما العام الذي كانت فيه المعركة الفاصلة بين المسلمين والتتار في (عين جالوت) شمال فلسطين في شهر رمضان؟",
      "options": ["685 هـ", "568 هـ", "856 هـ", "658 هـ"],
      "answer": "658 هـ"
    },
    {
      "id": 15,
      "question": "في أي عام تُوفي العز بن عبد السلام؟",
      "options": ["532 هـ", "577 هـ", "660 هـ", "589 هـ"],
      "answer": "660 هـ"
    },
    {
      "id": 16,
      "question": "ما الذكرى الموافقة لتحرير القدس من أيدي الصليبيين على يد صلاح الدين الأيوبي؟",
      "options": [
        "أول أيام عيد الفطر",
        "الإسراء و المعراج",
        "الهجرة النبوية",
        "المولد النبوي"
      ],
      "answer": "الإسراء و المعراج"
    },
    {
      "id": 17,
      "question": "علام يدل إلغاء صلاح الدين الأيوبي كثيراً من الضرائب التي كانت تُثقل كاهل الناس؟",
      "options": ["التسامح", "العدل", "التقوى و الصلاح", "الكرم و الزهد"],
      "answer": "العدل"
    },
    {
      "id": 18,
      "question": "في أي عام كانت معركة حطين من يوم الجمعة الموافق 27 رجب؟",
      "options": ["584 هـ", "582 هـ", "581 هـ", "583 هـ"],
      "answer": "583 هـ"
    },
    {
      "id": 19,
      "question": "ما المدة التي استمر فيها احتلال الصليبيين للقدس؟",
      "options": ["62 سنة", "42 سنة", "72 سنة", "92 سنة"],
      "answer": "92 سنة"
    },
    {
      "id": 20,
      "question": "ما أول عمل اهتم به صلاح الدين الأيوبي في سبيل تحرير القدس؟",
      "options": [
        "قتال الصليبيين",
        "توحيد المسلمين",
        "التفاوض مع الأعداء",
        "تثبيت النصر وتعزيز"
      ],
      "answer": "توحيد المسلمين"
    },
    {
      "id": 21,
      "question": "علام يطلق معنى البدعة عند العلماء؟",
      "options": [
        "على كل أمر حديث وجديد",
        "كل مستحدث مخالف لأصول الدين",
        "كل ما هو غريب على المسلمين",
        "ما استجد في حياتنا من عادات وتقاليد"
      ],
      "answer": "كل مستحدث مخالف لأصول الدين"
    },
    {
      "id": 22,
      "question": "ما هي أخطر صور البدع؟",
      "options": [
        "ما لم يفعله الرسول -صلى الله عليه وسلم -",
        "البدعة في العقيدة",
        "استخدام السبحة",
        "زيارة القبور يوم العيد"
      ],
      "answer": "البدعة في العقيدة"
    },
    {
      "id": 23,
      "question": "واحدة مما يأتي ليست من صور البدعة المحرمة. ما هي؟",
      "options": [
        "ما كان مغيرا للعقيدة الإسلامية",
        "أداء العبادة على غير الكيفية المشروعة",
        "ما يندرج تحت قاعدة عامة أو أصل",
        "التقرب إلى الله بعبادة لم يشرعها"
      ],
      "answer": "ما يندرج تحت قاعدة عامة أو أصل"
    },
    {
      "id": 24,
      "question": "ما أفضل الأعمال التي لا ينقطع ثوابها بعد موت صاحبها؟",
      "options": [
        "الرباط",
        "الصدقة الجارية",
        "العلم النافع",
        "الدعاء للوالدين"
      ],
      "answer": "الصدقة الجارية"
    },
    {
      "id": 25,
      "question": "أي من الآتي لا يُعد من الصدقة الجارية؟",
      "options": [
        "بناء المدارس",
        "بناء المساجد",
        "إكرام الضيف",
        "حفر الآبار"
      ],
      "answer": "إكرام الضيف"
    },
    {
      "id": 26,
      "question": "ما المعنى المستفاد من قوله تعالى: \"وقل رب ارحمهما كما ربياني صغيرا\"؟",
      "options": [
        "الصدقة عن الوالدين",
        "الدعاء للوالدين",
        "الحج عنهما",
        "قضاء الدين عنهما"
      ],
      "answer": "الدعاء للوالدين"
    },
    {
      "id": 27,
      "question": "في حق من يرتكب المشرك معصية الشرك بالله تعالى؟",
      "options": [
        "حق المجتمع",
        "حق الله تعالى وحق نفسه",
        "حق الله تعالى",
        "حق نفسه"
      ],
      "answer": "حق الله تعالى وحق نفسه"
    },
    {
      "id": 28,
      "question": "أن يجعل العبد مع الله تعالى مثيلا يساويه به. ما هو؟",
      "options": ["النفاق", "الكفر", "الشرك", "الرياء"],
      "answer": "الشرك"
    },
    {
      "id": 29,
      "question": "من أول من عُرف بالشرك من البشرية؟",
      "options": [
        "قوم آدم عليه السلام",
        "قوم نوح عليه السلام",
        "قوم لوط عليه السلام",
        "قوم صالح عليه السلام"
      ],
      "answer": "قوم نوح عليه السلام"
    },
    {
      "id": 30,
      "question": "لماذا أبطل الإسلام الاعتقاد بالتطير؟",
      "options": [
        "لأنه لا يدفع مضرة ولا يجلب منفعة",
        "لاشتماله على ألفاظ شركية",
        "لما فيه من تعظيم لغير الله تعالى",
        "لأنه يحبط العمل ويخرج من الملة"
      ],
      "answer": "لأنه لا يدفع مضرة ولا يجلب منفعة"
    },
    {
      "id": 31,
      "question": "ما حكم الحلف بغير الله تعالى إن لم يقصد الحالف تعظيم المحلوف به؟",
      "options": ["شرك أكبر", "جائز", "مكروه", "شرك أصغر"],
      "answer": "شرك أصغر"
    },
    {
      "id": 32,
      "question": "ما المقصود بالرقية؟",
      "options": [
        "أدعية وحركات متناسقة يُقصد بها الاستعاذة من الضر",
        "ألفاظ وحركات متناسقة يقصد بها جلب النفع ودفع الضرر",
        "أدعية وحركات يقصد بها جذب المحبة بين الزوجين ودفع التنافر بينهما",
        "أدعية وألفاظ يُقصد منها الاستعانة أو الاستعاذة بقصد طلب نفع ودفع ضر"
      ],
      "answer": "أدعية وألفاظ يُقصد منها الاستعانة أو الاستعاذة بقصد طلب نفع ودفع ضر"
    },
    {
      "id": 33,
      "question": "علام يطلق (التصديق بالجنان و الإقرار باللسان و العمل بالجوارح)؟",
      "options": ["الإسلام", "الإحسان", "الإيمان", "التقوى"],
      "answer": "الإيمان"
    },
    {
      "id": 34,
      "question": "ما معيار صلاح الأعمال و أساس قبولها أو رفضها؟",
      "options": ["الإنسان", "الذكر و الشكر", "التواضع", "الإيمان"],
      "answer": "الإيمان"
    },
    {
      "id": 35,
      "question": "ما المقصود بالعمل بالجوارح كأحد مقومات الإيمان؟",
      "options": [
        "الإقرار بالشهادتين",
        "شعائر الدين المعروفة",
        "الاعتقاد بحقائق الإيمان",
        "الإيمان بالله و ملائكته"
      ],
      "answer": "شعائر الدين المعروفة"
    },
    {
      "id": 36,
      "question": "ما المقصود بالقوانين العامة التي تحكم حركة الأحداث والوقائع في الحياة؟",
      "options": [
        "سنن الله -تعالى -الله في المجتمعات",
        "الاستخَلاف",
        "سنن الفطرة",
        "عَلامات الساعة"
      ],
      "answer": "سنن الله -تعالى -الله في المجتمعات"
    },
    {
      "id": 37,
      "question": "ما السنة التي تُعد من سنن الله -تعالى- في المجتمعات مما يأتي؟",
      "options": [
        "الإيجابية",
        "الثبات والشمول",
        "التغيير والاستبدال",
        "الوحدة والتماسك"
      ],
      "answer": "التغيير والاستبدال"
    },
    {
      "id": 38,
      "question": "ما الآية المتممة للآية \"ولاتقولوا لمن يقتل في سبيل الله أموات......؟",
      "options": [
        "إن الله مع الصابرين",
        "بل أحياء ولكن لاتشعرون",
        "وبشر الصابرين",
        "بل أحياء عند ربهم يرزقون"
      ],
      "answer": "بل أحياء ولكن لاتشعرون"
    },
    {
      "id": 39,
      "question": "ما المقصود بـ\"حمل النفس على الحق و ثباتها عند المكاره\"؟",
      "options": ["الشكر", "الصبر", "الرباط", "الذكر"],
      "answer": "الصبر"
    },
    {
      "id": 40,
      "question": "ما الموضع الذي يشمل على مد لازم حرفي مثقل؟",
      "options": ["الم", "الر", "طه", "يس"],
      "answer": "الم"
    },
    {
      "id": 41,
      "question": "ما مرادف (يسومونكم- يبلونكم) على الترتيب؟",
      "options": [
        "يلومونكم- نختبركم",
        "يغيثونكم- نختبركم",
        "يذيقونكم- نهلككم",
        "يذيقونكم- نختبركم"
      ],
      "answer": "يذيقونكم- نختبركم"
    },
    {
      "id": 42,
      "question": "ما الموضع الذي يشمل مد لازم حرفي مثقل؟",
      "options": ["الر", "طسم", "يس", "طه"],
      "answer": "طسم"
    },
    {
      "id": 43,
      "question": "مانوع المد على الترتيب في الآية \"وإذ قلنا للملائكة اسجدوا لآدم فسجدوا إلا إبليس\"؟",
      "options": [
        "منفصل وبدل ومتصل",
        "متصل وبدل وبدل",
        "متصل وبدل ومنفصل",
        "متصل ومنفصل وبدل"
      ],
      "answer": "متصل وبدل ومنفصل"
    },
    {
      "id": 44,
      "question": "ما المدان في كلمة \"مدهامّتان\" وقفاً؟",
      "options": [
        "كلمي مثقل وعارض للسكون",
        "كلمي مثقل وبدل",
        "منفصل وعارض للسكون",
        "متصل وعارض للسكون"
      ],
      "answer": "كلمي مثقل وعارض للسكون"
    },
    {
      "id": 45,
      "question": "ما المد الذي يكون في الحروف المقطعة في فواتح السور القرآنية؟",
      "options": [
        "مد اللين",
        "العارض للسكون",
        "اللازم الكلمي",
        "اللازم الحرفي"
      ],
      "answer": "اللازم الحرفي"
    },
    {
      "id": 46,
      "question": "ما الكلمتان اللتان تتفقان في مقدار المد والحكم والسبب؟",
      "options": [
        "مؤمنون وشيء",
        "مستقيم وآدم",
        "صيف وآمنوا",
        "إيتاء ويا أيها"
      ],
      "answer": "مؤمنون وشيء"
    },
    {
      "id": 47,
      "question": "أي من المقاطع الآتية تمد مداً طبيعياً؟",
      "options": ["عسق", "ق", "طه", "الم"],
      "answer": "طه"
    },
    {
      "id": 48,
      "question": "ما معنى كلمة سرابيلهم؟",
      "options": ["ثيابهم", "طعامهم", "شرابهم", "مساكنهم"],
      "answer": "ثيابهم"
    },
    {
      "id": 49,
      "question": "ما الصفة التي نعبر عنها بقولنا \"نحول يدخل على صوت الحرف فلا يمتلئ الفم بصداه\"؟",
      "options": [
        "المد الطبيعي",
        "التفخيم",
        "الترقيق",
        "السكون العارض"
      ],
      "answer": "الترقيق"
    },
    {
      "id": 50,
      "question": "أي من الحروف الآتية تفخم دائماً؟",
      "options": ["نقص عسلكم", "قطب جد", "خص ضغط قظ", "حي طهر"],
      "answer": "خص ضغط قظ"
    }


],

2:[
   

    {
      "id": 1,
      "question": "ما المقصود بـ (اليمين المنعقدة)؟",
      "options": [
        "اليمين التي تغمس صاحبها في النار",
        "الحلف مع تعمد الكذب",
        "الحلف دون قصد اليمين",
        "الحلف مع قصد اليمين"
      ],
      "answer": "الحلف مع قصد اليمين"
    },
    {
      "id": 2,
      "question": "ما حكم النذر في الأصل؟",
      "options": ["واجب", "مكروه", "مباح", "حرام"],
      "answer": "مكروه"
    },
    {
      "id": 3,
      "question": "علام يدل قوله تعالى: \"لا يؤاخذكم الله باللغو في أيمانكم\"؟",
      "options": [
        "وجوب الكفارة في اليمين المنعقدة",
        "وجوب الكفارة في يمين اللغو",
        "وجوب الوفاء باليمين",
        "لا كفارة في يمين اللغو"
      ],
      "answer": "لا كفارة في يمين اللغو"
    },
    {
      "id": 4,
      "question": "ما الذي يُستثنى من جهاد فرض العين مما يأتي؟",
      "options": [
        "إذا كان بين المسلمين وبين البلاد الأخرى عهد",
        "إذا احتل العدو بلداً من بلاد المسلمين",
        "إذا حضر المقاتل ساحة القتال",
        "إذا استنفر الإمام فئة من الناس للقتال"
      ],
      "answer": "إذا كان بين المسلمين وبين البلاد الأخرى عهد"
    },
    {
      "id": 5,
      "question": "ما العام الذي ولد فيه العز بن عبد السلام بدمشق؟",
      "options": ["576 هـ", "578 هـ", "577 هـ", "579 هـ"],
      "answer": "577 هـ"
    },
    {
      "id": 6,
      "question": "ما المعركة التي اشترك العز بن عبد السلام بقتال التتار فيها؟",
      "options": ["حطين", "عين جالوت", "شقحب", "دمياط"],
      "answer": "عين جالوت"
    },
    {
      "id": 7,
      "question": "ما الذكرى الموافقة لتحرير القدس من أيدي الصليبيين على يد صلاح الدين الأيوبي؟",
      "options": [
        "أول أيام عيد الفطر",
        "الإسراء و المعراج",
        "الهجرة النبوية",
        "المولد النبوي"
      ],
      "answer": "الإسراء و المعراج"
    },
    {
      "id": 8,
      "question": "علام يدل إلغاء صلاح الدين الأيوبي كثيراً من الضرائب التي كانت تُثقل كاهل الناس؟",
      "options": ["التسامح", "العدل", "التقوى و الصلاح", "الكرم و الزهد"],
      "answer": "العدل"
    },
    {
      "id": 9,
      "question": "ما هي أخطر صور البدع؟",
      "options": [
        "ما لم يفعله الرسول -صلى الله عليه وسلم -",
        "البدعة في العقيدة",
        "استخدام السبحة",
        "زيارة القبور يوم العيد"
      ],
      "answer": "البدعة في العقيدة"
    },
    {
      "id": 10,
      "question": "ما أفضل الأعمال التي لا ينقطع ثوابها بعد موت صاحبها؟",
      "options": [
        "الرباط",
        "الصدقة الجارية",
        "العلم النافع",
        "الدعاء للوالدين"
      ],
      "answer": "الصدقة الجارية"
    },
    {
      "id": 11,
      "question": "أن يجعل العبد مع الله تعالى مثيلا يساويه به. ما هو؟",
      "options": ["النفاق", "الكفر", "الشرك", "الرياء"],
      "answer": "الشرك"
    },
    {
      "id": 12,
      "question": "لماذا أبطل الإسلام الاعتقاد بالتطير؟",
      "options": [
        "لأنه لا يدفع مضرة ولا يجلب منفعة",
        "لاشتماله على ألفاظ شركية",
        "لما فيه من تعظيم لغير الله تعالى",
        "لأنه يحبط العمل ويخرج من الملة"
      ],
      "answer": "لأنه لا يدفع مضرة ولا يجلب منفعة"
    },
    {
      "id": 13,
      "question": "ما المقصود بالرقية؟",
      "options": [
        "أدعية وحركات متناسقة يُقصد بها الاستعاذة من الضر",
        "ألفاظ وحركات متناسقة يقصد بها جلب النفع ودفع الضرر",
        "أدعية وحركات يقصد بها جذب المحبة بين الزوجين ودفع التنافر بينهما",
        "أدعية وألفاظ يُقصد منها الاستعانة أو الاستعاذة بقصد طلب نفع ودفع ضر"
      ],
      "answer": "أدعية وألفاظ يُقصد منها الاستعانة أو الاستعاذة بقصد طلب نفع ودفع ضر"
    },
    {
      "id": 14,
      "question": "علام يطلق (التصديق بالجنان و الإقرار باللسان و العمل بالجوارح)؟",
      "options": ["الإسلام", "الإحسان", "الإيمان", "التقوى"],
      "answer": "الإيمان"
    },
    {
      "id": 15,
      "question": "ما المقصود بالقوانين العامة التي تحكم حركة الأحداث والوقائع في الحياة؟",
      "options": [
        "سنن الله -تعالى -الله في المجتمعات",
        "الاستخَلاف",
        "سنن الفطرة",
        "عَلامات الساعة"
      ],
      "answer": "سنن الله -تعالى -الله في المجتمعات"
    },
    {
      "id": 16,
      "question": "ما الآية المتممة للآية \"ولاتقولوا لمن يقتل في سبيل الله أموات......؟",
      "options": [
        "إن الله مع الصابرين",
        "بل أحياء ولكن لاتشعرون",
        "وبشر الصابرين",
        "بل أحياء عند ربهم يرزقون"
      ],
      "answer": "بل أحياء ولكن لاتشعرون"
    },
    {
      "id": 17,
      "question": "ما الموضع الذي يشمل على مد لازم حرفي مثقل؟",
      "options": ["الم", "الر", "طه", "يس"],
      "answer": "الم"
    },
    {
      "id": 18,
      "question": "ما مرادف (يسومونكم- يبلونكم) على الترتيب؟",
      "options": [
        "يلومونكم- نختبركم",
        "يغيثونكم- نختبركم",
        "يذيقونكم- نهلككم",
        "يذيقونكم- نختبركم"
      ],
      "answer": "يذيقونكم- نختبركم"
    },
    {
      "id": 19,
      "question": "ما الموضع الذي يشمل مد لازم حرفي مثقل؟",
      "options": ["الر", "طسم", "يس", "طه"],
      "answer": "طسم"
    },
    {
      "id": 20,
      "question": "مانوع المد على الترتيب في الآية \"وإذ قلنا للملائكة اسجدوا لآدم فسجدوا إلا إبليس\"؟",
      "options": [
        "منفصل وبدل ومتصل",
        "متصل وبدل وبدل",
        "متصل وبدل ومنفصل",
        "متصل ومنفصل وبدل"
      ],
      "answer": "متصل وبدل ومنفصل"
    },
    {
      "id": 21,
      "question": "ما المدان في كلمة \"مدهامّتان\" وقفاً؟",
      "options": [
        "كلمي مثقل وعارض للسكون",
        "كلمي مثقل وبدل",
        "منفصل وعارض للسكون",
        "متصل وعارض للسكون"
      ],
      "answer": "كلمي مثقل وعارض للسكون"
    },
    {
      "id": 22,
      "question": "ما المد الذي يكون في الحروف المقطعة في فواتح السور القرآنية؟",
      "options": [
        "مد اللين",
        "العارض للسكون",
        "اللازم الكلمي",
        "اللازم الحرفي"
      ],
      "answer": "اللازم الحرفي"
    },
    {
      "id": 23,
      "question": "ما الكلمتان اللتان تتفقان في مقدار المد والحكم والسبب؟",
      "options": [
        "مؤمنون وشيء",
        "مستقيم وآدم",
        "صيف وآمنوا",
        "إيتاء ويا أيها"
      ],
      "answer": "مؤمنون وشيء"
    },
    {
      "id": 24,
      "question": "أي من المقاطع الآتية تمد مداً طبيعياً؟",
      "options": ["عسق", "ق", "طه", "الم"],
      "answer": "طه"
    },
    {
      "id": 25,
      "question": "ما معنى كلمة سرابيلهم؟",
      "options": ["ثيابهم", "طعامهم", "شرابهم", "مساكنهم"],
      "answer": "ثيابهم"
    },
    {
      "id": 26,
      "question": "ما الصفة التي نعبر عنها بقولنا \"نحول يدخل على صوت الحرف فلا يمتلئ الفم بصداه\"؟",
      "options": [
        "المد الطبيعي",
        "التفخيم",
        "الترقيق",
        "السكون العارض"
      ],
      "answer": "الترقيق"
    },
    {
      "id": 27,
      "question": "أي من الحروف الآتية تفخم دائماً؟",
      "options": ["نقص عسلكم", "قطب جد", "خص ضغط قظ", "حي طهر"],
      "answer": "خص ضغط قظ"
    },
    {
      "id": 28,
      "question": "ما حكم اليمين في الشهادة أمام القاضي لإثبات حق لمستحقه؟",
      "options": ["مكروهة", "واجبة", "مندوبة", "مباحة"],
      "answer": "واجبة"
    },
    {
      "id": 29,
      "question": "أي من الآتي لا يعتبر من كفارة اليمين على التخيير؟",
      "options": ["الصوم", "كسوة عشرة مساكين", "تحرير رقبة مؤمنة", "إطعام عشرة مساكين"],
      "answer": "كسوة عشرة مساكين"
    },
    {
      "id": 30,
      "question": "في أي عام كانت معركة حطين من يوم الجمعة الموافق 27 رجب؟",
      "options": ["584 هـ", "582 هـ", "581 هـ", "583 هـ"],
      "answer": "583 هـ"
    },
    {
      "id": 31,
      "question": "ما المدة التي استمر فيها احتلال الصليبيين للقدس؟",
      "options": ["62 سنة", "42 سنة", "72 سنة", "92 سنة"],
      "answer": "92 سنة"
    },
    {
      "id": 32,
      "question": "ما أول عمل اهتم به صلاح الدين الأيوبي في سبيل تحرير القدس؟",
      "options": [
        "قتال الصليبيين",
        "توحيد المسلمين",
        "التفاوض مع الأعداء",
        "تثبيت النصر وتعزيز"
      ],
      "answer": "توحيد المسلمين"
    },
    {
      "id": 33,
      "question": "واحدة مما يأتي ليست من صور البدعة المحرمة. ما هي؟",
      "options": [
        "ما كان مغيرا للعقيدة الإسلامية",
        "أداء العبادة على غير الكيفية المشروعة",
        "ما يندرج تحت قاعدة عامة أو أصل",
        "التقرب إلى الله بعبادة لم يشرعها"
      ],
      "answer": "ما يندرج تحت قاعدة عامة أو أصل"
    },
    {
      "id": 34,
      "question": "أي من الآتي لا يُعد من الصدقة الجارية؟",
      "options": [
        "بناء المدارس",
        "بناء المساجد",
        "إكرام الضيف",
        "حفر الآبار"
      ],
      "answer": "إكرام الضيف"
    },
    {
      "id": 35,
      "question": "ما المعنى المستفاد من قوله تعالى: \"وقل رب ارحمهما كما ربياني صغيرا\"؟",
      "options": [
        "الصدقة عن الوالدين",
        "الدعاء للوالدين",
        "الحج عنهما",
        "قضاء الدين عنهما"
      ],
      "answer": "الدعاء للوالدين"
    },
    {
      "id": 36,
      "question": "في حق من يرتكب المشرك معصية الشرك بالله تعالى؟",
      "options": [
        "حق المجتمع",
        "حق الله تعالى وحق نفسه",
        "حق الله تعالى",
        "حق نفسه"
      ],
      "answer": "حق الله تعالى وحق نفسه"
    },
    {
      "id": 37,
      "question": "من أول من عُرف بالشرك من البشرية؟",
      "options": [
        "قوم آدم عليه السلام",
        "قوم نوح عليه السلام",
        "قوم لوط عليه السلام",
        "قوم صالح عليه السلام"
      ],
      "answer": "قوم نوح عليه السلام"
    },
    {
      "id": 38,
      "question": "ما حكم الحلف بغير الله تعالى إن لم يقصد الحالف تعظيم المحلوف به؟",
      "options": ["شرك أكبر", "جائز", "مكروه", "شرك أصغر"],
      "answer": "شرك أصغر"
    },
    {
      "id": 39,
      "question": "ما معيار صلاح الأعمال و أساس قبولها أو رفضها؟",
      "options": ["الإنسان", "الذكر و الشكر", "التواضع", "الإيمان"],
      "answer": "الإيمان"
    },
    {
      "id": 40,
      "question": "ما المقصود بالعمل بالجوارح كأحد مقومات الإيمان؟",
      "options": [
        "الإقرار بالشهادتين",
        "شعائر الدين المعروفة",
        "الاعتقاد بحقائق الإيمان",
        "الإيمان بالله و ملائكته"
      ],
      "answer": "شعائر الدين المعروفة"
    },
    {
      "id": 41,
      "question": "ما السنة التي تُعد من سنن الله -تعالى- في المجتمعات مما يأتي؟",
      "options": [
        "الإيجابية",
        "الثبات والشمول",
        "التغيير والاستبدال",
        "الوحدة والتماسك"
      ],
      "answer": "التغيير والاستبدال"
    },
    {
      "id": 42,
      "question": "ما المقصود بـ\"حمل النفس على الحق و ثباتها عند المكاره\"؟",
      "options": ["الشكر", "الصبر", "الرباط", "الذكر"],
      "answer": "الصبر"
    },
    {
      "id": 43,
      "question": "أي من الحروف الآتية تفخم دائماً؟",
      "options": ["نقص عسلكم", "قطب جد", "خص ضغط قظ", "حي طهر"],
      "answer": "خص ضغط قظ"
    },
    {
      "id": 44,
      "question": "ما المد الذي يكون في الحروف المقطعة في فواتح السور القرآنية؟",
      "options": [
        "مد اللين",
        "العارض للسكون",
        "اللازم الكلمي",
        "اللازم الحرفي"
      ],
      "answer": "اللازم الحرفي"
    },
    {
      "id": 45,
      "question": "ما الكلمتان اللتان تتفقان في مقدار المد والحكم والسبب؟",
      "options": [
        "مؤمنون وشيء",
        "مستقيم وآدم",
        "صيف وآمنوا",
        "إيتاء ويا أيها"
      ],
      "answer": "مؤمنون وشيء"
    },
    {
      "id": 46,
      "question": "أي من المقاطع الآتية تمد مداً طبيعياً؟",
      "options": ["عسق", "ق", "طه", "الم"],
      "answer": "طه"
    },
    {
      "id": 47,
      "question": "ما معنى كلمة سرابيلهم؟",
      "options": ["ثيابهم", "طعامهم", "شرابهم", "مساكنهم"],
      "answer": "ثيابهم"
    },
    {
      "id": 48,
      "question": "ما الصفة التي نعبر عنها بقولنا \"نحول يدخل على صوت الحرف فلا يمتلئ الفم بصداه\"؟",
      "options": [
        "المد الطبيعي",
        "التفخيم",
        "الترقيق",
        "السكون العارض"
      ],
      "answer": "الترقيق"
    },
    {
      "id": 49,
      "question": "أي من الحروف الآتية تفخم دائماً؟",
      "options": ["نقص عسلكم", "قطب جد", "خص ضغط قظ", "حي طهر"],
      "answer": "خص ضغط قظ"
    },
    {
      "id": 50,
      "question": "ما المدان في كلمة \"مدهامّتان\" وقفاً؟",
      "options": [
        "كلمي مثقل وعارض للسكون",
        "كلمي مثقل وبدل",
        "منفصل وعارض للسكون",
        "متصل وعارض للسكون"
      ],
      "answer": "كلمي مثقل وعارض للسكون"
    }
  ],

};

            // تعيين اسم المادة
            document.getElementById('subject-name').textContent = `اختبار ${subjectName}`;
            
            // إنشاء قائمة الوحدات
            const unitsList = document.getElementById('units-list');
            units.forEach(unit => {
                const unitBtn = document.createElement('button');
                unitBtn.className = 'unit-btn';
                unitBtn.textContent = unit.name;
                unitBtn.dataset.unitId = unit.id;
                unitBtn.addEventListener('click', () => startQuiz(unit.id));
                unitsList.appendChild(unitBtn);
            });
            
            // متغيرات النظام
            let currentUnit = null;
            let currentPart = 1;
            let totalParts = 0;
            let userAnswers = {};
            let timerInterval = null;
            let startTime = null;
            let timeLeft = localStorage.getItem('quiz_time_left') ? parseInt(localStorage.getItem('quiz_time_left')) : 3600; // 30 دقيقة بالثواني
            
            // عناصر واجهة المستخدم
            const quizSection = document.getElementById('quiz-section');
            const resultsSection = document.getElementById('results');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const submitBtn = document.getElementById('submit-btn');
            const timerElement = document.getElementById('timer');
            const printBtn = document.getElementById('print-btn');
            
            // بدء المؤقت
            function startTimer() {
                startTime = Date.now();
                updateTimerDisplay();
                timerInterval = setInterval(updateTimer, 1000);
                localStorage.setItem('quiz_time_left', timeLeft.toString());
            }
            
            // تحديث المؤقت
            function updateTimer() {
                timeLeft--;
                updateTimerDisplay();
                localStorage.setItem('quiz_time_left', timeLeft.toString());
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitQuiz();
                }
            }
            
            // تحديث عرض المؤقت
            function updateTimerDisplay() {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            // بدء الاختبار
            function startQuiz(unitId) {
                currentUnit = unitId;
                userAnswers = {};
                currentPart = 1;
                
                // إخفاء قائمة الوحدات
                unitsList.style.display = 'none';
                
                // عرض قسم الاختبار
                quizSection.style.display = 'block';
                quizSection.classList.add('active');
                
                // إعداد الأسئلة
                setupQuestions(unitId);
                
                // بدء المؤقت
                if (!timerInterval) {
                    startTimer();
                }
            }
            
            // إعداد الأسئلة
            function setupQuestions(unitId) {
                const questions = quizzes[unitId];
                totalParts = Math.ceil(questions.length / 3);
                
                // مسح الأقسام السابقة
                const quizSection = document.getElementById('quiz-section');
                const existingParts = quizSection.querySelectorAll('.question-part');
                existingParts.forEach(part => {
                    if (!part.classList.contains('active')) {
                        part.remove();
                    }
                });
                
                // إنشاء أقسام جديدة
                for (let i = 1; i <= totalParts; i++) {
                    if (i === 1) continue; // تخطي القسم الأول الموجود بالفعل
                    
                    const partDiv = document.createElement('div');
                    partDiv.className = 'question-part';
                    partDiv.dataset.part = i;
                    quizSection.insertBefore(partDiv, document.querySelector('.navigation-btns'));
                }
                
                // تعبئة الأسئلة في الأقسام
                questions.forEach((question, index) => {
                    const partNumber = Math.floor(index / 3) + 1;
                    const partDiv = document.querySelector(`.question-part[data-part="${partNumber}"]`);
                    
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'question';
                    questionDiv.dataset.questionId = question.id;
                    
                    const questionTitle = document.createElement('h3');
                    questionTitle.textContent = `السؤال ${index + 1}: ${question.question}`;
                    
                    const optionsDiv = document.createElement('div');
                    optionsDiv.className = 'options';
                    
                    question.options.forEach((option, optIndex) => {
                        const optionDiv = document.createElement('div');
                        optionDiv.className = 'option';
                        optionDiv.textContent = option;
                        optionDiv.dataset.option = option;
                        
                        optionDiv.addEventListener('click', function() {
                            // إزالة التحديد من جميع الخيارات لهذا السؤال
                            const allOptions = this.parentElement.querySelectorAll('.option');
                            allOptions.forEach(opt => opt.classList.remove('selected'));
                            
                            // تحديد الخيار الحالي
                            this.classList.add('selected');
                            
                            // حفظ الإجابة
                            userAnswers[question.id] = option;
                        });
                        
                        optionsDiv.appendChild(optionDiv);
                    });
                    
                    questionDiv.appendChild(questionTitle);
                    questionDiv.appendChild(optionsDiv);
                    partDiv.appendChild(questionDiv);
                });
                
                // عرض القسم الأول
                showPart(1);
            }
            
            // عرض قسم معين
            function showPart(partNumber) {
                // إخفاء جميع الأقسام
                document.querySelectorAll('.question-part').forEach(part => {
                    part.classList.remove('active');
                });
                
                // عرض القسم المطلوب
                document.querySelector(`.question-part[data-part="${partNumber}"]`).classList.add('active');
                
                // تحديث أزرار التنقل
                prevBtn.disabled = partNumber === 1;
                nextBtn.disabled = partNumber === totalParts;
                
                // تحديث الإجابات المحددة مسبقاً
                const currentPartQuestions = document.querySelectorAll(`.question-part[data-part="${partNumber}"] .question`);
                currentPartQuestions.forEach(questionDiv => {
                    const questionId = parseInt(questionDiv.dataset.questionId);
                    if (userAnswers[questionId]) {
                        const options = questionDiv.querySelectorAll('.option');
                        options.forEach(option => {
                            if (option.dataset.option === userAnswers[questionId]) {
                                option.classList.add('selected');
                            }
                        });
                    }
                });
            }
            
            // تقديم الاختبار
            function submitQuiz() {
                clearInterval(timerInterval);
                localStorage.removeItem('quiz_time_left');
                
                // إخفاء قسم الاختبار
                quizSection.style.display = 'none';
                
                // عرض النتائج
                showResults();

            }
            
            // عرض النتائج
            function showResults() {
                const questions = quizzes[currentUnit];
                let correctCount = 0;
                const resultsContent = document.getElementById('results-content');
                resultsContent.innerHTML = '';
                
                // حساب النتائج
                questions.forEach(question => {
                    const isCorrect = userAnswers[question.id] === question.answer;
                    if (isCorrect) correctCount++;
                    
                    const resultItem = document.createElement('div');
                    resultItem.className = 'result-item';
                    
                    const resultQuestion = document.createElement('div');
                    resultQuestion.className = 'result-question';
                    resultQuestion.textContent = question.question;
                    
                    const userAnswerDiv = document.createElement('div');
                    userAnswerDiv.className = `user-answer ${isCorrect ? 'correct' : 'wrong'}`;
                    userAnswerDiv.textContent = `إجابتك: ${userAnswers[question.id] || 'لم يتم الإجابة'}`;
                    
                    const correctAnswerDiv = document.createElement('div');
                    correctAnswerDiv.className = 'correct-answer';
                    correctAnswerDiv.textContent = `الإجابة الصحيحة: ${question.answer}`;
                    
                    resultItem.appendChild(resultQuestion);
                    resultItem.appendChild(userAnswerDiv);
                    resultItem.appendChild(correctAnswerDiv);
                    resultsContent.appendChild(resultItem);
                    

                });
                
                // عرض النتيجة النهائية
                const scorePercentage = Math.round((correctCount / questions.length) * 100);
                document.getElementById('score-display').textContent = `علامتك: ${correctCount} من ${questions.length} (${scorePercentage}%)`;
                
                // حساب الوقت المستغرق
                const timeSpent = 3600 - timeLeft;
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                document.getElementById('time-taken').textContent = `الوقت المستغرق: ${minutes} دقائق و ${seconds} ثواني`;
                
                // عرض قسم النتائج
                resultsSection.style.display = 'block';
                saveQuizResult(correctCount, questions.length, `${minutes} دقائق و ${seconds} ثواني`);

            }
            
            // أحداث الأزرار
            prevBtn.addEventListener('click', function() {
                if (currentPart > 1) {
                    currentPart--;
                    showPart(currentPart);
                }
            });
            
            nextBtn.addEventListener('click', function() {
                if (currentPart < totalParts) {
                    currentPart++;
                    showPart(currentPart);
                }
            });
            
            submitBtn.addEventListener('click', submitQuiz);
            
            printBtn.addEventListener('click', function() {
                window.print();
            });
            
            // استعادة المؤقت إذا كان هناك اختبار جاري
            if (localStorage.getItem('quiz_time_left')) {
                updateTimerDisplay();
            }
        });
    </script>
</body>
</html>